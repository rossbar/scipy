<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.fft.next_fast_len &mdash; SciPy v1.5.0.dev0+47ffc1e Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5.0.dev0+47ffc1e',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.5.0.dev0+47ffc1e Reference Guide" href="../index.html" >
    <link rel="up" title="Discrete Fourier transforms (scipy.fft)" href="../fft.html" >
    <link rel="next" title="scipy.fft.set_workers" href="scipy.fft.set_workers.html" >
    <link rel="prev" title="scipy.fft.rfftfreq" href="scipy.fft.rfftfreq.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="../index.html">
      <img style="border: 0;" alt="SciPy" src="../_static/img/scipy_org_logo.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="https://scipy.org/">SciPy.org</a></li>
        <li class="active"><a href="https://docs.scipy.org/">Docs</a></li>
	
        <li class="active"><a href="../index.html">SciPy v1.5.0.dev0+47ffc1e Reference Guide</a></li>
	
          <li class="active"><a href="../fft.html" accesskey="U">Discrete Fourier transforms (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fft</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.fft.set_workers.html" title="scipy.fft.set_workers"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.fft.rfftfreq.html" title="scipy.fft.rfftfreq"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-fft-next-fast-len">
<h1>scipy.fft.next_fast_len<a class="headerlink" href="#scipy-fft-next-fast-len" title="Permalink to this headline">¶</a></h1>
<dl class="attribute">
<dt id="scipy.fft.next_fast_len">
<code class="sig-prename descclassname">fft.</code><code class="sig-name descname">next_fast_len</code><a class="reference external" href="https://github.com/scipy/scipy/blob/47ffc1e/scipy/fft/_helper.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.fft.next_fast_len" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the next fast size of input data to <code class="docutils literal notranslate"><span class="pre">fft</span></code>, for zero-padding, etc.</p>
<p>SciPy’s FFT algorithms gain their speed by a recursive divide and conquer
strategy. This relies on efficient functions for small prime factors of the
input length. Thus, the transforms are fastest when using composites of the
prime factors handled by the fft implementation. If there are efficient
functions for all radices &lt;= <em class="xref py py-obj">n</em>, then the result will be a number <em class="xref py py-obj">x</em>
&gt;= <code class="docutils literal notranslate"><span class="pre">target</span></code> with only prime factors &lt; <em class="xref py py-obj">n</em>. (Also known as <em class="xref py py-obj">n</em>-smooth
numbers)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target</strong><span class="classifier">int</span></dt><dd><p>Length to start searching from. Must be a positive integer.</p>
</dd>
<dt><strong>real</strong><span class="classifier">bool, optional</span></dt><dd><p>True if the FFT involves real input or output (e.g., <a class="reference internal" href="scipy.fft.rfft.html#scipy.fft.rfft" title="scipy.fft.rfft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rfft</span></code></a> or <a class="reference internal" href="scipy.fft.hfft.html#scipy.fft.hfft" title="scipy.fft.hfft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hfft</span></code></a> but
not <a class="reference internal" href="../fft.html#module-scipy.fft" title="scipy.fft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fft</span></code></a>). Defaults to False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">int</span></dt><dd><p>The smallest fast length greater than or equal to <code class="docutils literal notranslate"><span class="pre">target</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The result of this function may change in future as performance
considerations change, for example, if new prime factors are added.</p>
<p>Calling <a class="reference internal" href="../fft.html#module-scipy.fft" title="scipy.fft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fft</span></code></a> or <a class="reference internal" href="scipy.fft.ifft.html#scipy.fft.ifft" title="scipy.fft.ifft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ifft</span></code></a> with real input data performs an <code class="docutils literal notranslate"><span class="pre">'R2C'</span></code>
transform internally.</p>
<p class="rubric">Examples</p>
<p>On a particular machine, an FFT of prime length takes 17 ms:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">fft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_len</span> <span class="o">=</span> <span class="mi">93059</span>  <span class="c1"># prime length is worst case for speed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">min_len</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<p>Zero-padding to the next regular length reduces computation time to
1.3 ms, a speedup of 13 times:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fft</span><span class="o">.</span><span class="n">next_fast_len</span><span class="p">(</span><span class="n">min_len</span><span class="p">)</span>
<span class="go">93312</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">93312</span><span class="p">)</span>
</pre></div>
</div>
<p>Rounding up to the next power of 2 is not optimal, taking 1.9 ms to
compute; 1.3 times longer than the size given by <code class="docutils literal notranslate"><span class="pre">next_fast_len</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">131072</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.fft.rfftfreq.html"
                        title="previous chapter">scipy.fft.rfftfreq</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.fft.set_workers.html"
                        title="next chapter">scipy.fft.set_workers</a></p>
<div id="searchbox" style="display: none" role="search">
  <h4>Quick search</h4>
    <div>
    <form class="search" action="../search.html" method="get">
      <input type="text" style="width: inherit;" name="q" />
      <input type="submit" value="search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2019, The SciPy community.
      </li>
      <li>
      Last updated on Dec 16, 2019.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.3.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>