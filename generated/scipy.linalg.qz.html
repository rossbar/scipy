<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.linalg.qz &mdash; SciPy v1.5.0.dev0+47ffc1e Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5.0.dev0+47ffc1e',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.5.0.dev0+47ffc1e Reference Guide" href="../index.html" >
    <link rel="up" title="Linear algebra (scipy.linalg)" href="../linalg.html" >
    <link rel="next" title="scipy.linalg.ordqz" href="scipy.linalg.ordqz.html" >
    <link rel="prev" title="scipy.linalg.rq" href="scipy.linalg.rq.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="../index.html">
      <img style="border: 0;" alt="SciPy" src="../_static/img/scipy_org_logo.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="https://scipy.org/">SciPy.org</a></li>
        <li class="active"><a href="https://docs.scipy.org/">Docs</a></li>
	
        <li class="active"><a href="../index.html">SciPy v1.5.0.dev0+47ffc1e Reference Guide</a></li>
	
          <li class="active"><a href="../linalg.html" accesskey="U">Linear algebra (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.linalg.ordqz.html" title="scipy.linalg.ordqz"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.linalg.rq.html" title="scipy.linalg.rq"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-linalg-qz">
<h1>scipy.linalg.qz<a class="headerlink" href="#scipy-linalg-qz" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.linalg.qz">
<code class="sig-prename descclassname">scipy.linalg.</code><code class="sig-name descname">qz</code><span class="sig-paren">(</span><em class="sig-param">A</em>, <em class="sig-param">B</em>, <em class="sig-param">output='real'</em>, <em class="sig-param">lwork=None</em>, <em class="sig-param">sort=None</em>, <em class="sig-param">overwrite_a=False</em>, <em class="sig-param">overwrite_b=False</em>, <em class="sig-param">check_finite=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/47ffc1e/scipy/linalg/_decomp_qz.py#L148-L265"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.linalg.qz" title="Permalink to this definition">¶</a></dt>
<dd><p>QZ decomposition for generalized eigenvalues of a pair of matrices.</p>
<p>The QZ, or generalized Schur, decomposition for a pair of N x N
nonsymmetric matrices (A,B) is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span><span class="o">*</span><span class="n">AA</span><span class="o">*</span><span class="n">Z</span><span class="s1">&#39;, Q*BB*Z&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where AA, BB is in generalized Schur form if BB is upper-triangular
with non-negative diagonal and AA is upper-triangular, or for real QZ
decomposition (<code class="docutils literal notranslate"><span class="pre">output='real'</span></code>) block upper triangular with 1x1
and 2x2 blocks. In this case, the 1x1 blocks correspond to real
generalized eigenvalues and 2x2 blocks are ‘standardized’ by making
the corresponding elements of BB have the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="n">a</span> <span class="mi">0</span> <span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span> <span class="n">b</span> <span class="p">]</span>
</pre></div>
</div>
<p>and the pair of corresponding 2x2 blocks in AA and BB will have a complex
conjugate pair of generalized eigenvalues. If (<code class="docutils literal notranslate"><span class="pre">output='complex'</span></code>) or
A and B are complex matrices, Z’ denotes the conjugate-transpose of Z.
Q and Z are unitary matrices.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>A</strong><span class="classifier">(N, N) array_like</span></dt><dd><p>2-D array to decompose</p>
</dd>
<dt><strong>B</strong><span class="classifier">(N, N) array_like</span></dt><dd><p>2-D array to decompose</p>
</dd>
<dt><strong>output</strong><span class="classifier">{‘real’, ‘complex’}, optional</span></dt><dd><p>Construct the real or complex QZ decomposition for real matrices.
Default is ‘real’.</p>
</dd>
<dt><strong>lwork</strong><span class="classifier">int, optional</span></dt><dd><p>Work array size. If None or -1, it is automatically computed.</p>
</dd>
<dt><strong>sort</strong><span class="classifier">{None, callable, ‘lhp’, ‘rhp’, ‘iuc’, ‘ouc’}, optional</span></dt><dd><p>NOTE: THIS INPUT IS DISABLED FOR NOW. Use ordqz instead.</p>
<p>Specifies whether the upper eigenvalues should be sorted. A callable
may be passed that, given a eigenvalue, returns a boolean denoting
whether the eigenvalue should be sorted to the top-left (True). For
real matrix pairs, the sort function takes three real arguments
(alphar, alphai, beta). The eigenvalue
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">(alphar</span> <span class="pre">+</span> <span class="pre">alphai*1j)/beta</span></code>. For complex matrix pairs or
output=’complex’, the sort function takes two complex arguments
(alpha, beta). The eigenvalue <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">(alpha/beta)</span></code>.  Alternatively,
string parameters may be used:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘lhp’   Left-hand plane (x.real &lt; 0.0)</p></li>
<li><p>‘rhp’   Right-hand plane (x.real &gt; 0.0)</p></li>
<li><p>‘iuc’   Inside the unit circle (x*x.conjugate() &lt; 1.0)</p></li>
<li><p>‘ouc’   Outside the unit circle (x*x.conjugate() &gt; 1.0)</p></li>
</ul>
</div></blockquote>
<p>Defaults to None (no sorting).</p>
</dd>
<dt><strong>overwrite_a</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to overwrite data in a (may improve performance)</p>
</dd>
<dt><strong>overwrite_b</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to overwrite data in b (may improve performance)</p>
</dd>
<dt><strong>check_finite</strong><span class="classifier">bool, optional</span></dt><dd><p>If true checks the elements of <em class="xref py py-obj">A</em> and <em class="xref py py-obj">B</em> are finite numbers. If
false does no checking and passes matrix through to
underlying algorithm.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>AA</strong><span class="classifier">(N, N) ndarray</span></dt><dd><p>Generalized Schur form of A.</p>
</dd>
<dt><strong>BB</strong><span class="classifier">(N, N) ndarray</span></dt><dd><p>Generalized Schur form of B.</p>
</dd>
<dt><strong>Q</strong><span class="classifier">(N, N) ndarray</span></dt><dd><p>The left Schur vectors.</p>
</dd>
<dt><strong>Z</strong><span class="classifier">(N, N) ndarray</span></dt><dd><p>The right Schur vectors.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="scipy.linalg.ordqz.html#scipy.linalg.ordqz" title="scipy.linalg.ordqz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ordqz</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Q is transposed versus the equivalent function in Matlab.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.11.0.</span></p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">AA</span><span class="p">,</span> <span class="n">BB</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">qz</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">AA</span>
<span class="go">array([[-13.40928183,  -4.62471562,   1.09215523],</span>
<span class="go">       [  0.        ,   0.        ,   1.22805978],</span>
<span class="go">       [  0.        ,   0.        ,   0.31973817]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">BB</span>
<span class="go">array([[ 0.33362547, -1.37393632,  0.02179805],</span>
<span class="go">       [ 0.        ,  1.68144922,  0.74683866],</span>
<span class="go">       [ 0.        ,  0.        ,  0.9258294 ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span>
<span class="go">array([[ 0.14134727, -0.97562773,  0.16784365],</span>
<span class="go">       [ 0.49835904, -0.07636948, -0.86360059],</span>
<span class="go">       [ 0.85537081,  0.20571399,  0.47541828]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span>
<span class="go">array([[-0.24900855, -0.51772687,  0.81850696],</span>
<span class="go">       [-0.79813178,  0.58842606,  0.12938478],</span>
<span class="go">       [-0.54861681, -0.6210585 , -0.55973739]])</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.linalg.rq.html"
                        title="previous chapter">scipy.linalg.rq</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.linalg.ordqz.html"
                        title="next chapter">scipy.linalg.ordqz</a></p>
<div id="searchbox" style="display: none" role="search">
  <h4>Quick search</h4>
    <div>
    <form class="search" action="../search.html" method="get">
      <input type="text" style="width: inherit;" name="q" />
      <input type="submit" value="search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2019, The SciPy community.
      </li>
      <li>
      Last updated on Dec 16, 2019.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.3.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>