<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.cluster.hierarchy.maxdists &mdash; SciPy v1.5.0.dev0+47ffc1e Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5.0.dev0+47ffc1e',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.5.0.dev0+47ffc1e Reference Guide" href="../index.html" >
    <link rel="up" title="Hierarchical clustering (scipy.cluster.hierarchy)" href="../cluster.hierarchy.html" >
    <link rel="next" title="scipy.cluster.hierarchy.maxRstat" href="scipy.cluster.hierarchy.maxRstat.html" >
    <link rel="prev" title="scipy.cluster.hierarchy.maxinconsts" href="scipy.cluster.hierarchy.maxinconsts.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="../index.html">
      <img style="border: 0;" alt="SciPy" src="../_static/img/scipy_org_logo.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="https://scipy.org/">SciPy.org</a></li>
        <li class="active"><a href="https://docs.scipy.org/">Docs</a></li>
	
        <li class="active"><a href="../index.html">SciPy v1.5.0.dev0+47ffc1e Reference Guide</a></li>
	
          <li class="active"><a href="../cluster.html" >Clustering package (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.cluster</span></code>)</a></li>
          <li class="active"><a href="../cluster.hierarchy.html" accesskey="U">Hierarchical clustering (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.cluster.hierarchy.maxRstat.html" title="scipy.cluster.hierarchy.maxRstat"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.cluster.hierarchy.maxinconsts.html" title="scipy.cluster.hierarchy.maxinconsts"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-cluster-hierarchy-maxdists">
<h1>scipy.cluster.hierarchy.maxdists<a class="headerlink" href="#scipy-cluster-hierarchy-maxdists" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.cluster.hierarchy.maxdists">
<code class="sig-prename descclassname">scipy.cluster.hierarchy.</code><code class="sig-name descname">maxdists</code><span class="sig-paren">(</span><em class="sig-param">Z</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/47ffc1e/scipy/cluster/hierarchy.py#L3746-L3826"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.cluster.hierarchy.maxdists" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum distance between any non-singleton cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>Z</strong><span class="classifier">ndarray</span></dt><dd><p>The hierarchical clustering encoded as a matrix. See
<code class="docutils literal notranslate"><span class="pre">linkage</span></code> for more information.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>maxdists</strong><span class="classifier">ndarray</span></dt><dd><p>A <code class="docutils literal notranslate"><span class="pre">(n-1)</span></code> sized numpy array of doubles; <code class="docutils literal notranslate"><span class="pre">MD[i]</span></code> represents
the maximum distance between any cluster (including
singletons) below and including the node with index i. More
specifically, <code class="docutils literal notranslate"><span class="pre">MD[i]</span> <span class="pre">=</span> <span class="pre">Z[Q(i)-n,</span> <span class="pre">2].max()</span></code> where <code class="docutils literal notranslate"><span class="pre">Q(i)</span></code> is the
set of all node indices below and including node i.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="scipy.cluster.hierarchy.linkage.html#scipy.cluster.hierarchy.linkage" title="scipy.cluster.hierarchy.linkage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">linkage</span></code></a></dt><dd><p>for a description of what a linkage matrix is.</p>
</dd>
<dt><a class="reference internal" href="scipy.cluster.hierarchy.is_monotonic.html#scipy.cluster.hierarchy.is_monotonic" title="scipy.cluster.hierarchy.is_monotonic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_monotonic</span></code></a></dt><dd><p>for testing for monotonicity of a linkage matrix.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">median</span><span class="p">,</span> <span class="n">maxdists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</pre></div>
</div>
<p>Given a linkage matrix <code class="docutils literal notranslate"><span class="pre">Z</span></code>, <a class="reference internal" href="#scipy.cluster.hierarchy.maxdists" title="scipy.cluster.hierarchy.maxdists"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.maxdists</span></code></a>
computes for each new cluster generated (i.e., for each row of the linkage
matrix) what is the maximum distance between any two child clusters.</p>
<p>Due to the nature of hierarchical clustering, in many cases this is going
to be just the distance between the two child clusters that were merged
to form the current one - that is, Z[:,2].</p>
<p>However, for non-monotonic cluster assignments such as
<a class="reference internal" href="scipy.cluster.hierarchy.median.html#scipy.cluster.hierarchy.median" title="scipy.cluster.hierarchy.median"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.median</span></code></a> clustering this is not always the
case: There may be cluster formations were the distance between the two
clusters merged is smaller than the distance between their children.</p>
<p>We can see this in an example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span>
<span class="go">array([[ 0.        ,  1.        ,  1.        ,  2.        ],</span>
<span class="go">       [ 3.        ,  4.        ,  1.        ,  2.        ],</span>
<span class="go">       [ 9.        , 10.        ,  1.        ,  2.        ],</span>
<span class="go">       [ 6.        ,  7.        ,  1.        ,  2.        ],</span>
<span class="go">       [ 2.        , 12.        ,  1.11803399,  3.        ],</span>
<span class="go">       [ 5.        , 13.        ,  1.11803399,  3.        ],</span>
<span class="go">       [ 8.        , 15.        ,  1.11803399,  3.        ],</span>
<span class="go">       [11.        , 14.        ,  1.11803399,  3.        ],</span>
<span class="go">       [18.        , 19.        ,  3.        ,  6.        ],</span>
<span class="go">       [16.        , 17.        ,  3.5       ,  6.        ],</span>
<span class="go">       [20.        , 21.        ,  3.25      , 12.        ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxdists</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="go">array([1.        , 1.        , 1.        , 1.        , 1.11803399,</span>
<span class="go">       1.11803399, 1.11803399, 1.11803399, 3.        , 3.5       ,</span>
<span class="go">       3.5       ])</span>
</pre></div>
</div>
<p>Note that while the distance between the two clusters merged when creating the
last cluster is 3.25, there are two children (clusters 16 and 17) whose distance
is larger (3.5). Thus, <a class="reference internal" href="#scipy.cluster.hierarchy.maxdists" title="scipy.cluster.hierarchy.maxdists"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.maxdists</span></code></a> returns 3.5 in
this case.</p>
</dd></dl>

</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.cluster.hierarchy.maxinconsts.html"
                        title="previous chapter">scipy.cluster.hierarchy.maxinconsts</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.cluster.hierarchy.maxRstat.html"
                        title="next chapter">scipy.cluster.hierarchy.maxRstat</a></p>
<div id="searchbox" style="display: none" role="search">
  <h4>Quick search</h4>
    <div>
    <form class="search" action="../search.html" method="get">
      <input type="text" style="width: inherit;" name="q" />
      <input type="submit" value="search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2019, The SciPy community.
      </li>
      <li>
      Last updated on Dec 16, 2019.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.3.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>