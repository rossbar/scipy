<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.optimize.fmin_l_bfgs_b &mdash; SciPy v1.5.0.dev0+47ffc1e Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5.0.dev0+47ffc1e',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.5.0.dev0+47ffc1e Reference Guide" href="../index.html" >
    <link rel="up" title="Optimization and root finding (scipy.optimize)" href="../optimize.html" >
    <link rel="next" title="scipy.optimize.fmin_tnc" href="scipy.optimize.fmin_tnc.html" >
    <link rel="prev" title="scipy.optimize.fmin_ncg" href="scipy.optimize.fmin_ncg.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="../index.html">
      <img style="border: 0;" alt="SciPy" src="../_static/img/scipy_org_logo.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="https://scipy.org/">SciPy.org</a></li>
        <li class="active"><a href="https://docs.scipy.org/">Docs</a></li>
	
        <li class="active"><a href="../index.html">SciPy v1.5.0.dev0+47ffc1e Reference Guide</a></li>
	
          <li class="active"><a href="../optimize.html" accesskey="U">Optimization and root finding (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.optimize.fmin_tnc.html" title="scipy.optimize.fmin_tnc"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.optimize.fmin_ncg.html" title="scipy.optimize.fmin_ncg"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-optimize-fmin-l-bfgs-b">
<h1>scipy.optimize.fmin_l_bfgs_b<a class="headerlink" href="#scipy-optimize-fmin-l-bfgs-b" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.optimize.fmin_l_bfgs_b">
<code class="sig-prename descclassname">scipy.optimize.</code><code class="sig-name descname">fmin_l_bfgs_b</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">x0</em>, <em class="sig-param">fprime=None</em>, <em class="sig-param">args=()</em>, <em class="sig-param">approx_grad=0</em>, <em class="sig-param">bounds=None</em>, <em class="sig-param">m=10</em>, <em class="sig-param">factr=10000000.0</em>, <em class="sig-param">pgtol=1e-05</em>, <em class="sig-param">epsilon=1e-08</em>, <em class="sig-param">iprint=-1</em>, <em class="sig-param">maxfun=15000</em>, <em class="sig-param">maxiter=15000</em>, <em class="sig-param">disp=None</em>, <em class="sig-param">callback=None</em>, <em class="sig-param">maxls=20</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/47ffc1e/scipy/optimize/lbfgsb.py#L49-L208"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.optimize.fmin_l_bfgs_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize a function func using the L-BFGS-B algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>func</strong><span class="classifier">callable f(x,*args)</span></dt><dd><p>Function to minimize.</p>
</dd>
<dt><strong>x0</strong><span class="classifier">ndarray</span></dt><dd><p>Initial guess.</p>
</dd>
<dt><strong>fprime</strong><span class="classifier">callable fprime(x,*args), optional</span></dt><dd><p>The gradient of <em class="xref py py-obj">func</em>. If None, then <em class="xref py py-obj">func</em> returns the function
value and the gradient (<code class="docutils literal notranslate"><span class="pre">f,</span> <span class="pre">g</span> <span class="pre">=</span> <span class="pre">func(x,</span> <span class="pre">*args)</span></code>), unless
<em class="xref py py-obj">approx_grad</em> is True in which case <em class="xref py py-obj">func</em> returns only <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
</dd>
<dt><strong>args</strong><span class="classifier">sequence, optional</span></dt><dd><p>Arguments to pass to <em class="xref py py-obj">func</em> and <em class="xref py py-obj">fprime</em>.</p>
</dd>
<dt><strong>approx_grad</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to approximate the gradient numerically (in which case
<em class="xref py py-obj">func</em> returns only the function value).</p>
</dd>
<dt><strong>bounds</strong><span class="classifier">list, optional</span></dt><dd><p><code class="docutils literal notranslate"><span class="pre">(min,</span> <span class="pre">max)</span></code> pairs for each element in <code class="docutils literal notranslate"><span class="pre">x</span></code>, defining
the bounds on that parameter. Use None or +-inf for one of <code class="docutils literal notranslate"><span class="pre">min</span></code> or
<code class="docutils literal notranslate"><span class="pre">max</span></code> when there is no bound in that direction.</p>
</dd>
<dt><strong>m</strong><span class="classifier">int, optional</span></dt><dd><p>The maximum number of variable metric corrections
used to define the limited memory matrix. (The limited memory BFGS
method does not store the full hessian but uses this many terms in an
approximation to it.)</p>
</dd>
<dt><strong>factr</strong><span class="classifier">float, optional</span></dt><dd><p>The iteration stops when
<code class="docutils literal notranslate"><span class="pre">(f^k</span> <span class="pre">-</span> <span class="pre">f^{k+1})/max{|f^k|,|f^{k+1}|,1}</span> <span class="pre">&lt;=</span> <span class="pre">factr</span> <span class="pre">*</span> <span class="pre">eps</span></code>,
where <code class="docutils literal notranslate"><span class="pre">eps</span></code> is the machine precision, which is automatically
generated by the code. Typical values for <em class="xref py py-obj">factr</em> are: 1e12 for
low accuracy; 1e7 for moderate accuracy; 10.0 for extremely
high accuracy. See Notes for relationship to <em class="xref py py-obj">ftol</em>, which is exposed
(instead of <em class="xref py py-obj">factr</em>) by the <a class="reference internal" href="scipy.optimize.minimize.html#scipy.optimize.minimize" title="scipy.optimize.minimize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code></a> interface to
L-BFGS-B.</p>
</dd>
<dt><strong>pgtol</strong><span class="classifier">float, optional</span></dt><dd><p>The iteration will stop when
<code class="docutils literal notranslate"><span class="pre">max{|proj</span> <span class="pre">g_i</span> <span class="pre">|</span> <span class="pre">i</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">n}</span> <span class="pre">&lt;=</span> <span class="pre">pgtol</span></code>
where <code class="docutils literal notranslate"><span class="pre">pg_i</span></code> is the i-th component of the projected gradient.</p>
</dd>
<dt><strong>epsilon</strong><span class="classifier">float, optional</span></dt><dd><p>Step size used when <em class="xref py py-obj">approx_grad</em> is True, for numerically
calculating the gradient</p>
</dd>
<dt><strong>iprint</strong><span class="classifier">int, optional</span></dt><dd><p>Controls the frequency of output. <code class="docutils literal notranslate"><span class="pre">iprint</span> <span class="pre">&lt;</span> <span class="pre">0</span></code> means no output;
<code class="docutils literal notranslate"><span class="pre">iprint</span> <span class="pre">=</span> <span class="pre">0</span></code>    print only one line at the last iteration;
<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">iprint</span> <span class="pre">&lt;</span> <span class="pre">99</span></code> print also f and <code class="docutils literal notranslate"><span class="pre">|proj</span> <span class="pre">g|</span></code> every iprint iterations;
<code class="docutils literal notranslate"><span class="pre">iprint</span> <span class="pre">=</span> <span class="pre">99</span></code>   print details of every iteration except n-vectors;
<code class="docutils literal notranslate"><span class="pre">iprint</span> <span class="pre">=</span> <span class="pre">100</span></code>  print also the changes of active set and final x;
<code class="docutils literal notranslate"><span class="pre">iprint</span> <span class="pre">&gt;</span> <span class="pre">100</span></code>  print details of every iteration including x and g.</p>
</dd>
<dt><strong>disp</strong><span class="classifier">int, optional</span></dt><dd><p>If zero, then no output. If a positive number, then this over-rides
<em class="xref py py-obj">iprint</em> (i.e., <em class="xref py py-obj">iprint</em> gets the value of <em class="xref py py-obj">disp</em>).</p>
</dd>
<dt><strong>maxfun</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum number of function evaluations.</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum number of iterations.</p>
</dd>
<dt><strong>callback</strong><span class="classifier">callable, optional</span></dt><dd><p>Called after each iteration, as <code class="docutils literal notranslate"><span class="pre">callback(xk)</span></code>, where <code class="docutils literal notranslate"><span class="pre">xk</span></code> is the
current parameter vector.</p>
</dd>
<dt><strong>maxls</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum number of line search steps (per iteration). Default is 20.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>Estimated position of the minimum.</p>
</dd>
<dt><strong>f</strong><span class="classifier">float</span></dt><dd><p>Value of <em class="xref py py-obj">func</em> at the minimum.</p>
</dd>
<dt><strong>d</strong><span class="classifier">dict</span></dt><dd><p>Information dictionary.</p>
<ul class="simple">
<li><p>d[‘warnflag’] is</p>
<ul>
<li><p>0 if converged,</p></li>
<li><p>1 if too many function evaluations or too many iterations,</p></li>
<li><p>2 if stopped for another reason, given in d[‘task’]</p></li>
</ul>
</li>
<li><p>d[‘grad’] is the gradient at the minimum (should be 0 ish)</p></li>
<li><p>d[‘funcalls’] is the number of function calls made.</p></li>
<li><p>d[‘nit’] is the number of iterations.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="scipy.optimize.minimize.html#scipy.optimize.minimize" title="scipy.optimize.minimize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimize</span></code></a></dt><dd><p>Interface to minimization algorithms for multivariate functions. See the ‘L-BFGS-B’ <em class="xref py py-obj">method</em> in particular. Note that the <em class="xref py py-obj">ftol</em> option is made available via that interface, while <em class="xref py py-obj">factr</em> is provided via this interface, where <em class="xref py py-obj">factr</em> is the factor multiplying the default machine floating-point precision to arrive at <em class="xref py py-obj">ftol</em>: <code class="docutils literal notranslate"><span class="pre">ftol</span> <span class="pre">=</span> <span class="pre">factr</span> <span class="pre">*</span> <span class="pre">numpy.finfo(float).eps</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>License of L-BFGS-B (FORTRAN code):</p>
<p>The version included here (in fortran code) is 3.0
(released April 25, 2011). It was written by Ciyou Zhu, Richard Byrd,
and Jorge Nocedal &lt;<a class="reference external" href="mailto:nocedal&#37;&#52;&#48;ece&#46;nwu&#46;edu">nocedal<span>&#64;</span>ece<span>&#46;</span>nwu<span>&#46;</span>edu</a>&gt;. It carries the following
condition for use:</p>
<p>This software is freely available, but we expect that all publications
describing work using this software, or all commercial products using it,
quote at least one of the references given below. This software is released
under the BSD License.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p>R. H. Byrd, P. Lu and J. Nocedal. A Limited Memory Algorithm for Bound
Constrained Optimization, (1995), SIAM Journal on Scientific and
Statistical Computing, 16, 5, pp. 1190-1208.</p></li>
<li><p>C. Zhu, R. H. Byrd and J. Nocedal. L-BFGS-B: Algorithm 778: L-BFGS-B,
FORTRAN routines for large scale bound constrained optimization (1997),
ACM Transactions on Mathematical Software, 23, 4, pp. 550 - 560.</p></li>
<li><p>J.L. Morales and J. Nocedal. L-BFGS-B: Remark on Algorithm 778: L-BFGS-B,
FORTRAN routines for large scale bound constrained optimization (2011),
ACM Transactions on Mathematical Software, 38, 1.</p></li>
</ul>
</dd></dl>

</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.optimize.fmin_ncg.html"
                        title="previous chapter">scipy.optimize.fmin_ncg</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.optimize.fmin_tnc.html"
                        title="next chapter">scipy.optimize.fmin_tnc</a></p>
<div id="searchbox" style="display: none" role="search">
  <h4>Quick search</h4>
    <div>
    <form class="search" action="../search.html" method="get">
      <input type="text" style="width: inherit;" name="q" />
      <input type="submit" value="search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2019, The SciPy community.
      </li>
      <li>
      Last updated on Dec 16, 2019.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.3.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>