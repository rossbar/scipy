<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.stats.wasserstein_distance &mdash; SciPy v1.5.0.dev0+47ffc1e Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5.0.dev0+47ffc1e',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.5.0.dev0+47ffc1e Reference Guide" href="../index.html" >
    <link rel="up" title="Statistical functions (scipy.stats)" href="../stats.html" >
    <link rel="next" title="scipy.stats.energy_distance" href="scipy.stats.energy_distance.html" >
    <link rel="prev" title="scipy.stats.zscore" href="scipy.stats.zscore.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="../index.html">
      <img style="border: 0;" alt="SciPy" src="../_static/img/scipy_org_logo.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="https://scipy.org/">SciPy.org</a></li>
        <li class="active"><a href="https://docs.scipy.org/">Docs</a></li>
	
        <li class="active"><a href="../index.html">SciPy v1.5.0.dev0+47ffc1e Reference Guide</a></li>
	
          <li class="active"><a href="../stats.html" accesskey="U">Statistical functions (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.stats.energy_distance.html" title="scipy.stats.energy_distance"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.stats.zscore.html" title="scipy.stats.zscore"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-stats-wasserstein-distance">
<h1>scipy.stats.wasserstein_distance<a class="headerlink" href="#scipy-stats-wasserstein-distance" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.stats.wasserstein_distance">
<code class="sig-prename descclassname">scipy.stats.</code><code class="sig-name descname">wasserstein_distance</code><span class="sig-paren">(</span><em class="sig-param">u_values</em>, <em class="sig-param">v_values</em>, <em class="sig-param">u_weights=None</em>, <em class="sig-param">v_weights=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/47ffc1e/scipy/stats/stats.py#L6934-L7008"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.stats.wasserstein_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the first Wasserstein distance between two 1D distributions.</p>
<p>This distance is also known as the earth mover’s distance, since it can be
seen as the minimum amount of “work” required to transform <span class="math notranslate nohighlight">\(u\)</span> into
<span class="math notranslate nohighlight">\(v\)</span>, where “work” is measured as the amount of distribution weight
that must be moved, multiplied by the distance it has to be moved.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>u_values, v_values</strong><span class="classifier">array_like</span></dt><dd><p>Values observed in the (empirical) distribution.</p>
</dd>
<dt><strong>u_weights, v_weights</strong><span class="classifier">array_like, optional</span></dt><dd><p>Weight for each value. If unspecified, each value is assigned the same
weight.
<em class="xref py py-obj">u_weights</em> (resp. <em class="xref py py-obj">v_weights</em>) must have the same length as
<em class="xref py py-obj">u_values</em> (resp. <em class="xref py py-obj">v_values</em>). If the weight sum differs from 1, it
must still be positive and finite so that the weights can be normalized
to sum to 1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>distance</strong><span class="classifier">float</span></dt><dd><p>The computed distance between the distributions.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The first Wasserstein distance between the distributions <span class="math notranslate nohighlight">\(u\)</span> and
<span class="math notranslate nohighlight">\(v\)</span> is:</p>
<div class="math notranslate nohighlight">
\[l_1 (u, v) = \inf_{\pi \in \Gamma (u, v)} \int_{\mathbb{R} \times
\mathbb{R}} |x-y| \mathrm{d} \pi (x, y)\]</div>
<p>where <span class="math notranslate nohighlight">\(\Gamma (u, v)\)</span> is the set of (probability) distributions on
<span class="math notranslate nohighlight">\(\mathbb{R} \times \mathbb{R}\)</span> whose marginals are <span class="math notranslate nohighlight">\(u\)</span> and
<span class="math notranslate nohighlight">\(v\)</span> on the first and second factors respectively.</p>
<p>If <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> are the respective CDFs of <span class="math notranslate nohighlight">\(u\)</span> and
<span class="math notranslate nohighlight">\(v\)</span>, this distance also equals to:</p>
<div class="math notranslate nohighlight">
\[l_1(u, v) = \int_{-\infty}^{+\infty} |U-V|\]</div>
<p>See <a class="reference internal" href="#rbc4e517f9be6-2" id="id1">[2]</a> for a proof of the equivalence of both definitions.</p>
<p>The input distributions can be empirical, therefore coming from samples
whose values are effectively inputs of the function, or they can be seen as
generalized functions, in which case they are weighted sums of Dirac delta
functions located at the specified values.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="rbc4e517f9be6-1"><span class="brackets">1</span></dt>
<dd><p>“Wasserstein metric”, <a class="reference external" href="https://en.wikipedia.org/wiki/Wasserstein_metric">https://en.wikipedia.org/wiki/Wasserstein_metric</a></p>
</dd>
<dt class="label" id="rbc4e517f9be6-2"><span class="brackets"><a class="fn-backref" href="#id1">2</a></span></dt>
<dd><p>Ramdas, Garcia, Cuturi “On Wasserstein Two Sample Testing and Related
Families of Nonparametric Tests” (2015). <a class="reference external" href="https://arxiv.org/abs/1509.02237">arXiv:1509.02237</a>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">wasserstein_distance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wasserstein_distance</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="go">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wasserstein_distance</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wasserstein_distance</span><span class="p">([</span><span class="mf">3.4</span><span class="p">,</span> <span class="mf">3.9</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">7.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
<span class="go">4.0781331438047861</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.stats.zscore.html"
                        title="previous chapter">scipy.stats.zscore</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.stats.energy_distance.html"
                        title="next chapter">scipy.stats.energy_distance</a></p>
<div id="searchbox" style="display: none" role="search">
  <h4>Quick search</h4>
    <div>
    <form class="search" action="../search.html" method="get">
      <input type="text" style="width: inherit;" name="q" />
      <input type="submit" value="search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2019, The SciPy community.
      </li>
      <li>
      Last updated on Dec 16, 2019.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.3.0.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>